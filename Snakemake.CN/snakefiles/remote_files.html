

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Remote files &mdash; Snakemake 5.6.0+8.g89bc383.dirty documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx-argparse.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utils" href="utils.html" />
    <link rel="prev" title="Modularization" href="modularization.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Snakemake
          

          
          </a>

          
            
            
              <div class="version">
                5.6.0+8.g89bc383.dirty
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Snakemake Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/short.html">Short tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Executing workflows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../executable.html">Executing Snakemake</a></li>
</ul>
<p class="caption"><span class="caption-text">Defining workflows</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="writing_snakefiles.html">Writing Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="rules.html">Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="modularization.html">Modularization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Remote files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#amazon-simple-storage-service-s3">Amazon Simple Storage Service (S3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#google-cloud-storage-gs">Google Cloud Storage (GS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-transfer-over-ssh-sftp">File transfer over SSH (SFTP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#read-only-web-http-s">Read-only web (HTTP[s])</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-transfer-protocol-ftp">File Transfer Protocol (FTP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dropbox">Dropbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xrootd">XRootD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#genbank-ncbi-entrez">GenBank / NCBI Entrez</a></li>
<li class="toctree-l2"><a class="reference internal" href="#webdav">WebDAV</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gfal">GFAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">GridFTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="#remote-cross-provider-transfers">Remote cross-provider transfers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#irods">iRODS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ega">EGA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Distribution and Reproducibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="reporting.html">Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/snakemake.html">The Snakemake API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/snakemake_utils.html">Additional utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/internal/modules.html">Internal API</a></li>
</ul>
<p class="caption"><span class="caption-text">Project Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../project_info/citations.html">Citing and Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_info/more_resources.html">More Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_info/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_info/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_info/authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_info/history.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_info/license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Snakemake</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Remote files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/snakefiles/remote_files.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="remote-files">
<span id="snakefiles-remote-files"></span><h1>Remote files<a class="headerlink" href="#remote-files" title="Permalink to this headline">¶</a></h1>
<p>In versions <code class="docutils literal notranslate"><span class="pre">snakemake&gt;=3.5</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Snakefile</span></code> supports a wrapper function, <code class="docutils literal notranslate"><span class="pre">remote()</span></code>, indicating a file is on a remote storage provider (this is similar to <code class="docutils literal notranslate"><span class="pre">temp()</span></code> or <code class="docutils literal notranslate"><span class="pre">protected()</span></code>). In order to use all types of remote files, the Python packages <code class="docutils literal notranslate"><span class="pre">boto</span></code>, <code class="docutils literal notranslate"><span class="pre">moto</span></code>, <code class="docutils literal notranslate"><span class="pre">filechunkio</span></code>, <code class="docutils literal notranslate"><span class="pre">pysftp</span></code>, <code class="docutils literal notranslate"><span class="pre">dropbox</span></code>, <code class="docutils literal notranslate"><span class="pre">requests</span></code>, <code class="docutils literal notranslate"><span class="pre">ftputil</span></code>, <code class="docutils literal notranslate"><span class="pre">XRootD</span></code>, and <code class="docutils literal notranslate"><span class="pre">biopython</span></code> must be installed.</p>
<p>During rule execution, a remote file (or object) specified is downloaded to the local <code class="docutils literal notranslate"><span class="pre">cwd</span></code>, within a sub-directory bearing the same name as the remote provider. This sub-directory naming lets you have multiple remote origins with reduced likelihood of name collisions, and allows Snakemake to easily translate remote objects to local file paths. You can think of each local remote sub-directory as a local mirror of the remote system. The <code class="docutils literal notranslate"><span class="pre">remote()</span></code> wrapper is mutually-exclusive with the <code class="docutils literal notranslate"><span class="pre">temp()</span></code> and <code class="docutils literal notranslate"><span class="pre">protected()</span></code> wrappers.</p>
<p>Snakemake includes the following remote providers, supported by the corresponding classes:</p>
<ul class="simple">
<li>Amazon Simple Storage Service (AWS S3): <code class="docutils literal notranslate"><span class="pre">snakemake.remote.S3</span></code></li>
<li>Google Cloud Storage (GS): <code class="docutils literal notranslate"><span class="pre">snakemake.remote.GS</span></code></li>
<li>File transfer over SSH (SFTP): <code class="docutils literal notranslate"><span class="pre">snakemake.remote.SFTP</span></code></li>
<li>Read-only web (HTTP[S]): <code class="docutils literal notranslate"><span class="pre">snakemake.remote.HTTP</span></code></li>
<li>File transfer protocol (FTP): <code class="docutils literal notranslate"><span class="pre">snakemake.remote.FTP</span></code></li>
<li>Dropbox: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.dropbox</span></code></li>
<li>XRootD: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.XRootD</span></code></li>
<li>GenBank / NCBI Entrez: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.NCBI</span></code></li>
<li>WebDAV: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.webdav</span></code></li>
<li>GFAL: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.gfal</span></code></li>
<li>GridFTP: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.gridftp</span></code></li>
<li>iRODS: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.iRODS</span></code></li>
<li>EGA: <code class="docutils literal notranslate"><span class="pre">snakemake.remote.EGA</span></code></li>
</ul>
<div class="section" id="amazon-simple-storage-service-s3">
<h2>Amazon Simple Storage Service (S3)<a class="headerlink" href="#amazon-simple-storage-service-s3" title="Permalink to this headline">¶</a></h2>
<p>This section describes usage of the S3 RemoteProvider, and also provides an intro to remote files and their usage.</p>
<p>It is important to note that you must have credentials (<code class="docutils literal notranslate"><span class="pre">access_key_id</span></code> and <code class="docutils literal notranslate"><span class="pre">secret_access_key</span></code>) which permit read/write access. If a file only serves as input to a Snakemake rule, read access is sufficient. You may specify credentials as environment variables or in the file <code class="docutils literal notranslate"><span class="pre">=/.aws/credentials</span></code>, prefixed with <code class="docutils literal notranslate"><span class="pre">AWS_*</span></code>, as with a standard <a class="reference external" href="http://boto.readthedocs.org/en/latest/boto_config_tut.html">boto config</a>. Credentials may also be explicitly listed in the <code class="docutils literal notranslate"><span class="pre">Snakefile</span></code>, as shown below:</p>
<p>For the Amazon S3 and Google Cloud Storage providers, the sub-directory used must be the bucket name.</p>
<p>Using remote files is easy (AWS S3 shown):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">(</span><span class="n">access_key_id</span><span class="o">=</span><span class="s2">&quot;MYACCESSKEY&quot;</span><span class="p">,</span> <span class="n">secret_access_key</span><span class="o">=</span><span class="s2">&quot;MYSECRET&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">S3</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;bucket-name/file.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Expand still works as expected, just wrap the expansion:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">S3</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="s2">&quot;bucket-name/{letter}-2.txt&quot;</span><span class="p">,</span> <span class="n">letter</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<p>Only remote files needed to satisfy the DAG build are downloaded for the workflow. By default, remote files are downloaded prior to rule execution and are removed locally as soon as no rules depend on them. Remote files can be explicitly kept by setting the <code class="docutils literal notranslate"><span class="pre">keep_local=True</span></code> keyword argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">(</span><span class="n">access_key_id</span><span class="o">=</span><span class="s2">&quot;MYACCESSKEY&quot;</span><span class="p">,</span> <span class="n">secret_access_key</span><span class="o">=</span><span class="s2">&quot;MYSECRET&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">S3</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;bucket-name/prefix{split_id}.txt&#39;</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>If you wish to have a rule to simply download a file to a local copy, you can do so by declaring the same file path locally as is used by the remote file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">(</span><span class="n">access_key_id</span><span class="o">=</span><span class="s2">&quot;MYACCESSKEY&quot;</span><span class="p">,</span> <span class="n">secret_access_key</span><span class="o">=</span><span class="s2">&quot;MYSECRET&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">S3</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;bucket-name/out.txt&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s2">&quot;bucket-name/out.txt&quot;</span>
    <span class="n">run</span><span class="p">:</span>
        <span class="n">shell</span><span class="p">(</span><span class="s2">&quot;cp {output[0]} ./&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In some cases the rule can use the data directly on the remote provider, in these cases <code class="docutils literal notranslate"><span class="pre">stay_on_remote=True</span></code> can be set to avoid downloading/uploading data unnecessarily. Additionally, if the backend supports it, any potentially corrupt output files will be removed from the remote. The default for <code class="docutils literal notranslate"><span class="pre">stay_on_remote</span></code> and <code class="docutils literal notranslate"><span class="pre">keep_local</span></code> can be configured by setting these properties on the remote provider object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">(</span><span class="n">access_key_id</span><span class="o">=</span><span class="s2">&quot;MYACCESSKEY&quot;</span><span class="p">,</span> <span class="n">secret_access_key</span><span class="o">=</span><span class="s2">&quot;MYSECRET&quot;</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stay_on_remote</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The remote provider also supports a new <code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code> (see <a class="reference internal" href="../project_info/faq.html#glob-wildcards"><span class="std std-ref">How do I run my rule on all files of a certain directory?</span></a>) which acts the same as the local version of <code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code>, but for remote files:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">(</span><span class="n">access_key_id</span><span class="o">=</span><span class="s2">&quot;MYACCESSKEY&quot;</span><span class="p">,</span> <span class="n">secret_access_key</span><span class="o">=</span><span class="s2">&quot;MYSECRET&quot;</span><span class="p">)</span>
<span class="n">S3</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;bucket-name/{file_prefix}.txt&quot;</span><span class="p">)</span>

<span class="c1"># (result looks just like as if the local glob_wildcards() function were used on a locally with a folder called &quot;bucket-name&quot;)</span>
</pre></div>
</div>
<p>If the AWS CLI is installed it is possible to configure your keys globally. This removes the necessity of hardcoding the keys in the Snakefile. The interactive AWS credentials setup can be done using the following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aws</span> <span class="n">configure</span>
</pre></div>
</div>
<p>S3 then can be used without the keys.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, it is also possible to overwrite the S3 host via adding a <code class="docutils literal notranslate"><span class="pre">host</span></code> argument (taking a URL string) to <code class="docutils literal notranslate"><span class="pre">S3RemoteProvider</span></code>.</p>
</div>
<div class="section" id="google-cloud-storage-gs">
<h2>Google Cloud Storage (GS)<a class="headerlink" href="#google-cloud-storage-gs" title="Permalink to this headline">¶</a></h2>
<p>Usage of the GS provider is the same as the S3 provider.
For authentication, one simply needs to login via the <code class="docutils literal notranslate"><span class="pre">gcloud</span></code> tool before
executing Snakemake, i.e.:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> gcloud auth application-default login
</pre></div>
</div>
<p>In the Snakefile, no additional authentication information has to be provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.GS</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">GSRemoteProvider</span>
<span class="n">GS</span> <span class="o">=</span> <span class="n">GSRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">GS</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;bucket-name/file.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="file-transfer-over-ssh-sftp">
<h2>File transfer over SSH (SFTP)<a class="headerlink" href="#file-transfer-over-ssh-sftp" title="Permalink to this headline">¶</a></h2>
<p>Snakemake can use files on remove servers accessible via SFTP (i.e. most *nix servers).
It uses <a class="reference external" href="https://pysftp.readthedocs.org/en/release_0.2.8/pysftp.html#pysftp.Connection">pysftp</a> for the underlying support of SFTP, so the same connection options exist.
Assuming you have SSH keys already set up for the server you are using in the <code class="docutils literal notranslate"><span class="pre">Snakefile</span></code>, usage is simple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.SFTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>
<span class="n">SFTP</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">SFTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/path/to/file.bam&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The remote file addresses used must be specified with the host (domain or IP address) and the absolute path to the file on the remote server. A port may be specified if the SSH daemon on the server is listening on a port other than 22, in either the <code class="docutils literal notranslate"><span class="pre">RemoteProvider</span></code> or in each instance of <code class="docutils literal notranslate"><span class="pre">remote()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.SFTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>
<span class="n">SFTP</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">4040</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">SFTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/path/to/file.bam&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.SFTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>
<span class="n">SFTP</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">SFTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com:4040/path/to/file.bam&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The standard keyword arguments used by <a class="reference external" href="https://pysftp.readthedocs.org/en/release_0.2.8/pysftp.html#pysftp.Connection">pysftp</a> may be provided to the RemoteProvider to specify credentials (either password or private key):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.SFTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>
<span class="n">SFTP</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">private_key</span><span class="o">=</span><span class="s2">&quot;/Users/myusername/.ssh/particular_id_rsa&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">SFTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/path/to/file.bam&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.SFTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>
<span class="n">SFTP</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">SFTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/path/to/file.bam&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you share credentials between servers but connect to one on a different port, the alternate port may be specified in the <code class="docutils literal notranslate"><span class="pre">remote()</span></code> wrapper:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.SFTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>
<span class="n">SFTP</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">SFTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;some-example-server-1.com/path/to/file.bam&quot;</span><span class="p">),</span>
        <span class="n">SFTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;some-example-server-2.com:2222/path/to/file.bam&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>There is a <code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.SFTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>
<span class="n">SFTP</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">()</span>
<span class="n">SFTP</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;example.com/path/to/{sample}.bam&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="read-only-web-http-s">
<h2>Read-only web (HTTP[s])<a class="headerlink" href="#read-only-web-http-s" title="Permalink to this headline">¶</a></h2>
<p>Snakemake can access web resources via a read-only HTTP(S) provider.
This provider can be helpful for including public web data in a workflow.</p>
<p>Web addresses must be specified without protocol, so if your URI looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http://server3.example.com/path/to/myfile.tar.gz
</pre></div>
</div>
<p>The URI used in the <code class="docutils literal notranslate"><span class="pre">Snakefile</span></code> must look like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>server3.example.com/path/to/myfile.tar.gz
</pre></div>
</div>
<p>It is straightforward to use the HTTP provider to download a file to the <cite>cwd</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">snakemake.remote.HTTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">HTTPRemoteProvider</span>

<span class="n">HTTP</span> <span class="o">=</span> <span class="n">HTTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">HTTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;www.example.com/path/to/document.pdf&quot;</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">run</span><span class="p">:</span>
        <span class="n">outputName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">shell</span><span class="p">(</span><span class="s2">&quot;mv {input} {outputName}&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To connect on a different port, specify the port as part of the URI string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.HTTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">HTTPRemoteProvider</span>
<span class="n">HTTP</span> <span class="o">=</span> <span class="n">HTTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">HTTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;www.example.com:8080/path/to/document.pdf&quot;</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the HTTP provider always uses HTTPS (TLS). If you need to connect to a resource with regular HTTP (no TLS), you must explicitly include <code class="docutils literal notranslate"><span class="pre">insecure</span></code> as a <code class="docutils literal notranslate"><span class="pre">kwarg</span></code> to <code class="docutils literal notranslate"><span class="pre">remote()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.HTTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">HTTPRemoteProvider</span>
<span class="n">HTTP</span> <span class="o">=</span> <span class="n">HTTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">HTTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;www.example.com/path/to/document.pdf&quot;</span><span class="p">,</span> <span class="n">insecure</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>If the URI used includes characters not permitted in a local file path, you may include them as part of the <code class="docutils literal notranslate"><span class="pre">additional_request_string</span></code> in the <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> for <code class="docutils literal notranslate"><span class="pre">remote()</span></code>. This may also be useful for including additional parameters you don not want to be part of the local filename (since the URI string becomes the local file name).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.HTTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">HTTPRemoteProvider</span>
<span class="n">HTTP</span> <span class="o">=</span> <span class="n">HTTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">HTTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/query.php&quot;</span><span class="p">,</span> <span class="n">additional_request_string</span><span class="o">=</span><span class="s2">&quot;?range=2;3&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the file requires authentication, you can specify a username and password for HTTP Basic Auth with the Remote Provider, or with each instance of <cite>remote()</cite>.
For different types of authentication, you can pass in a Python <code class="docutils literal notranslate"><span class="pre">`requests.auth</span></code> object (see <a class="reference external" href="http://docs.python-requests.org/en/latest/api/#authentication">here</a>) the <cite>auth</cite> <code class="docutils literal notranslate"><span class="pre">kwarg</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.HTTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">HTTPRemoteProvider</span>
<span class="n">HTTP</span> <span class="o">=</span> <span class="n">HTTPRemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">HTTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/interactive.php&quot;</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.HTTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">HTTPRemoteProvider</span>
<span class="n">HTTP</span> <span class="o">=</span> <span class="n">HTTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">HTTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/interactive.php&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.HTTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">HTTPRemoteProvider</span>
<span class="n">HTTP</span> <span class="o">=</span> <span class="n">HTTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">HTTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/interactive.php&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">HTTPDigestAuth</span><span class="p">(</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="s2">&quot;mypassword&quot;</span><span class="p">),</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Since remote servers do not present directory contents uniformly, <code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code> is __not__ supported by the HTTP provider.</p>
</div>
<div class="section" id="file-transfer-protocol-ftp">
<h2>File Transfer Protocol (FTP)<a class="headerlink" href="#file-transfer-protocol-ftp" title="Permalink to this headline">¶</a></h2>
<p>Snakemake can work with files stored on regular FTP.
Currently supported are authenticated FTP and anonymous FTP, excluding FTP via TLS.</p>
<p>Usage is similar to the SFTP provider, however the paths specified are relative to the FTP home directory (since this is typically a chroot):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.FTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">FTPRemoteProvider</span>

<span class="n">FTP</span> <span class="o">=</span> <span class="n">FTPRemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">FTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/rel/path/to/file.tar.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The port may be specified in either the provider, or in each instance of <cite>remote()</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.FTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">FTPRemoteProvider</span>

<span class="n">FTP</span> <span class="o">=</span> <span class="n">FTPRemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">2121</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">FTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/rel/path/to/file.tar.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.FTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">FTPRemoteProvider</span>

<span class="n">FTP</span> <span class="o">=</span> <span class="n">FTPRemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">FTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com:2121/rel/path/to/file.tar.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Anonymous download of FTP resources is possible:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.FTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">FTPRemoteProvider</span>
<span class="n">FTP</span> <span class="o">=</span> <span class="n">FTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="c1"># only keeping the file so we can move it out to the cwd</span>
        <span class="n">FTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com/rel/path/to/file.tar.gz&quot;</span><span class="p">,</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">run</span><span class="p">:</span>
        <span class="n">shell</span><span class="p">(</span><span class="s2">&quot;mv {input} ./&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.FTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">FTPRemoteProvider</span>
<span class="n">FTP</span> <span class="o">=</span> <span class="n">FTPRemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">FTP</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;example.com/somedir/{file}.txt&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Setting <cite>immediate_close=True</cite> allows the use of a large number of remote FTP input files in a job where the endpoint server limits the number of concurrent connections. When <cite>immediate_close=True</cite>, Snakemake will terminate FTP connections after each remote file action (<cite>exists()</cite>, <cite>size()</cite>, <cite>download()</cite>, <cite>mtime()</cite>, etc.). This is in contrast to the default behavior which caches FTP details and leaves the connection open across actions to improve performance (closing the connection upon job termination).  :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.FTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">FTPRemoteProvider</span>
<span class="n">FTP</span> <span class="o">=</span> <span class="n">FTPRemoteProvider</span><span class="p">()</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="c1"># only keep the file so we can move it out to the cwd</span>
        <span class="c1"># This server limits the number of concurrent connections so we need to have Snakemake close each after each FTP action.</span>
        <span class="n">FTP</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="s2">&quot;ftp.example.com/rel/path/to/{file}&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">large_list</span><span class="p">),</span> <span class="n">keep_local</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">immediate_close</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">run</span><span class="p">:</span>
        <span class="n">shell</span><span class="p">(</span><span class="s2">&quot;mv {input} ./&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.FTP</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">FTPRemoteProvider</span>
<span class="n">FTP</span> <span class="o">=</span> <span class="n">FTPRemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;mypassword&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">FTP</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;example.com/somedir/{file}.txt&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="dropbox">
<h2>Dropbox<a class="headerlink" href="#dropbox" title="Permalink to this headline">¶</a></h2>
<p>The Dropbox remote provider allows you to upload and download from your <a class="reference external" href="https://www.dropbox.com">Dropbox</a> account without having the client installed on your machine. In order to use the provider you  first need to register an “app” on the <a class="reference external" href="https://www.dropbox.com/developers/apps/create">Dropbox developer website</a>, with access to the Full Dropbox. After registering, generate an OAuth2 access token. You will need the token to use the Snakemake Dropbox remote provider.</p>
<p>Using the Dropbox provider is straightforward:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.dropbox</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">DropboxRemoteProvider</span>
<span class="n">DBox</span> <span class="o">=</span> <span class="n">DropboxRemoteProvider</span><span class="p">(</span><span class="n">oauth2_access_token</span><span class="o">=</span><span class="s2">&quot;mytoken&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">DBox</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;path/to/input.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code> is supported:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.dropbox</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">DropboxRemoteProvider</span>
<span class="n">DBox</span> <span class="o">=</span> <span class="n">DropboxRemoteProvider</span><span class="p">(</span><span class="n">oauth2_access_token</span><span class="o">=</span><span class="s2">&quot;mytoken&quot;</span><span class="p">)</span>

<span class="n">DBox</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;path/to/{title}.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that Dropbox paths are case-insensitive.</p>
</div>
<div class="section" id="xrootd">
<h2>XRootD<a class="headerlink" href="#xrootd" title="Permalink to this headline">¶</a></h2>
<p>Snakemake can be used with <a class="reference external" href="http://xrootd.org/">XRootD</a> backed storage provided the python bindings are installed.
This is typically most useful when combined with the <code class="docutils literal notranslate"><span class="pre">stay_on_remote</span></code> flag to minimise local storage requirements.
This flag can be overridden on a file by file basis as described in the S3 remote. Additionally <code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code> is supported:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.XRootD</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">XRootDRemoteProvider</span>

<span class="n">XRootD</span> <span class="o">=</span> <span class="n">XRootDRemoteProvider</span><span class="p">(</span><span class="n">stay_on_remote</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">file_numbers</span> <span class="o">=</span> <span class="n">XRootD</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;root://eospublic.cern.ch//eos/opendata/lhcb/MasterclassDatasets/D0lifetime/2014/mclasseventv2_D0_{n}.root&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">XRootD</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="s2">&quot;local_data/mclasseventv2_D0_{n}.root&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">file_numbers</span><span class="p">))</span>

<span class="n">rule</span> <span class="n">make_data</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">XRootD</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;root://eospublic.cern.ch//eos/opendata/lhcb/MasterclassDatasets/D0lifetime/2014/mclasseventv2_D0_{n}.root&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s1">&#39;local_data/mclasseventv2_D0_{n}.root&#39;</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="s1">&#39;xrdcp {input[0]} {output[0]}&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="genbank-ncbi-entrez">
<h2>GenBank / NCBI Entrez<a class="headerlink" href="#genbank-ncbi-entrez" title="Permalink to this headline">¶</a></h2>
<p>Snakemake can directly source input files from <a class="reference external" href="https://www.ncbi.nlm.nih.gov/genbank/">GenBank</a> and other <a class="reference external" href="https://www.ncbi.nlm.nih.gov/books/NBK25497/table/chapter2.T._entrez_unique_identifiers_ui/?report=objectonly">NCBI Entrez databases</a> if the Biopython library is installed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.NCBI</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">NCBIRemoteProvider</span>
<span class="n">NCBI</span> <span class="o">=</span> <span class="n">NCBIRemoteProvider</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s2">&quot;someone@example.com&quot;</span><span class="p">)</span> <span class="c1"># email required by NCBI to prevent abuse</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s2">&quot;size.txt&quot;</span>

<span class="n">rule</span> <span class="n">download_and_count</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">NCBI</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;KY785484.1.fasta&quot;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s2">&quot;nuccore&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s2">&quot;size.txt&quot;</span>
    <span class="n">run</span><span class="p">:</span>
        <span class="n">shell</span><span class="p">(</span><span class="s2">&quot;wc -c {input} &gt; {output}&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The output format and source database of a record retrieved from GenBank is inferred from the file extension specified. For example, <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider().remote(&quot;KY785484.1.fasta&quot;,</span> <span class="pre">db=&quot;nuccore&quot;)</span></code> will download a FASTA file while <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider().remote(&quot;KY785484.1.gb&quot;,</span> <span class="pre">db=&quot;nuccore&quot;)</span></code> will download a GenBank-format file. If the options are ambiguous, Snakemake will raise an exception and inform the user of possible format choices. To see available formats, consult the <a class="reference external" href="https://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/?report=objectonly">Entrez EFetch documentation</a>. To view the valid file extensions for these formats, access <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider()._gb.valid_extensions</span></code>, or instantiate an <code class="docutils literal notranslate"><span class="pre">NCBI.NCBIHelper()</span></code> and access <code class="docutils literal notranslate"><span class="pre">NCBI.NCBIHelper().valid_extensions</span></code> (this is a property).</p>
<p>When used in conjunction with <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider().search()</span></code>, Snakemake and <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider().remote()</span></code> can be used to find accessions by query and download them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.NCBI</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">NCBIRemoteProvider</span>
<span class="n">NCBI</span> <span class="o">=</span> <span class="n">NCBIRemoteProvider</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s2">&quot;someone@example.com&quot;</span><span class="p">)</span> <span class="c1"># email required by NCBI to prevent abuse</span>

<span class="c1"># get accessions for the first 3 results in a search for full-length Zika virus genomes</span>
<span class="c1"># the query parameter accepts standard GenBank search syntax</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&quot;Zika virus&quot;[Organism] AND ((&quot;9000&quot;[SLEN] : &quot;20000&quot;[SLEN]) AND (&quot;2017/03/20&quot;[PDAT] : &quot;2017/03/24&quot;[PDAT])) &#39;</span>
<span class="n">accessions</span> <span class="o">=</span> <span class="n">NCBI</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">retmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># give the accessions a file extension to help the RemoteProvider determine the</span>
<span class="c1"># proper output type.</span>
<span class="n">input_files</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;{acc}.fasta&quot;</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="n">accessions</span><span class="p">)</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s2">&quot;sizes.txt&quot;</span>

<span class="n">rule</span> <span class="n">download_and_count</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="c1"># Since *.fasta files could come from several different databases, specify the database here.</span>
        <span class="c1"># if the input files are ambiguous, the provider will alert the user with possible options</span>
        <span class="c1"># standard options like &quot;seq_start&quot; are supported</span>
        <span class="n">NCBI</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">input_files</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s2">&quot;nuccore&quot;</span><span class="p">,</span> <span class="n">seq_start</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

    <span class="n">output</span><span class="p">:</span>
        <span class="s2">&quot;sizes.txt&quot;</span>
    <span class="n">run</span><span class="p">:</span>
        <span class="n">shell</span><span class="p">(</span><span class="s2">&quot;wc -c {input} &gt; sizes.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Normally, all accessions for a query are returned from <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider.search()</span></code>. To truncate the results, specify <code class="docutils literal notranslate"><span class="pre">retmax=&lt;desired_number&gt;</span></code>. Standard Entrez <a class="reference external" href="https://www.ncbi.nlm.nih.gov/books/NBK25499/#chapter4.EFetch">fetch query options</a> are supported as kwargs, and may be passed in to <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider.remote()</span></code> and <code class="docutils literal notranslate"><span class="pre">NCBI.RemoteProvider.search()</span></code>.</p>
</div>
<div class="section" id="webdav">
<h2>WebDAV<a class="headerlink" href="#webdav" title="Permalink to this headline">¶</a></h2>
<p>WebDAV support is currently <code class="docutils literal notranslate"><span class="pre">experimental</span></code> and available in Snakemake 4.0 and later.</p>
<p>Snakemake supports reading and writing WebDAV remote files. The protocol defaults to <code class="docutils literal notranslate"><span class="pre">https://</span></code>, but insecure connections
can be used by specifying <code class="docutils literal notranslate"><span class="pre">protocol==&quot;http://&quot;</span></code>. Similarly, the port defaults to 443, and can be overridden by specifying <code class="docutils literal notranslate"><span class="pre">port=##</span></code> or by including the port as part of the file address.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote</span> <span class="kn">import</span> <span class="n">webdav</span>

<span class="n">webdav</span> <span class="o">=</span> <span class="n">webdav</span><span class="o">.</span><span class="n">RemoteProvider</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="s2">&quot;http://&quot;</span><span class="p">)</span>

<span class="n">rule</span> <span class="n">a</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">webdav</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;example.com:8888/path/to/input_file.csv&quot;</span><span class="p">),</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="c1"># do something</span>
</pre></div>
</div>
</div>
<div class="section" id="gfal">
<h2>GFAL<a class="headerlink" href="#gfal" title="Permalink to this headline">¶</a></h2>
<p>GFAL support is available in Snakemake 4.1 and later.</p>
<p>Snakemake supports reading and writing remote files via the <a class="reference external" href="https://dmc.web.cern.ch/projects/gfal-2/home">GFAL</a> command line client (gfal-* commands).
By this, it supports various grid storage protocols like <a class="reference external" href="https://en.wikipedia.org/wiki/GridFTP">GridFTP</a>.
In general, if you are able to use the <cite>gfal-*</cite> commands directly, Snakemake support for GFAL will work as well.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote</span> <span class="kn">import</span> <span class="n">gfal</span>

<span class="n">gfal</span> <span class="o">=</span> <span class="n">gfal</span><span class="o">.</span><span class="n">RemoteProvider</span><span class="p">(</span><span class="n">retry</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">rule</span> <span class="n">a</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">gfal</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;gridftp.grid.sara.nl:2811/path/to/infile.txt&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="n">gfal</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;gridftp.grid.sara.nl:2811/path/to/outfile.txt&quot;</span><span class="p">)</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="c1"># do something</span>
</pre></div>
</div>
<p>Authentication has to be setup in the system, e.g. via certificates in the <code class="docutils literal notranslate"><span class="pre">.globus</span></code> directory.
Usually, this is already the case and no action has to be taken.
The keyword argument to the remote provider allows to set the number of retries (10 per default) in case of failed commands (the GRID is usually relatively unreliable).
The latter may be unsupported depending on the system configuration.</p>
<p>Note that GFAL support used together with the flags <code class="docutils literal notranslate"><span class="pre">--no-shared-fs</span></code> and <code class="docutils literal notranslate"><span class="pre">--default-remote-provider</span></code> enables you
to transparently use Snakemake in a grid computing environment without a shared network filesystem.
For an example see the <a class="reference external" href="https://github.com/Snakemake-Profiles/surfsara-grid">surfsara-grid configuration profile</a>.</p>
</div>
<div class="section" id="id5">
<h2>GridFTP<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>GridFTP support is available in Snakemake 4.3.0 and later.</p>
<p>As a more specialized alternative to the GFAL remote provider, Snakemake provides a <a class="reference external" href="https://en.wikipedia.org/wiki/GridFTP">GridFTP</a> remote provider.
This provider only supports the GridFTP protocol. Internally, it uses the <a class="reference external" href="http://toolkit.globus.org/toolkit/docs/latest-stable/gridftp/user/#globus-url-copy">globus-url-copy</a> command for downloads and uploads, while all other tasks are delegated to the GFAL remote provider.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote</span> <span class="kn">import</span> <span class="n">gridftp</span>

<span class="n">gridftp</span> <span class="o">=</span> <span class="n">gridftp</span><span class="o">.</span><span class="n">RemoteProvider</span><span class="p">(</span><span class="n">retry</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">rule</span> <span class="n">a</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">gridftp</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;gridftp.grid.sara.nl:2811/path/to/infile.txt&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="n">gridftp</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;gridftp.grid.sara.nl:2811/path/to/outfile.txt&quot;</span><span class="p">)</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="c1"># do something</span>
</pre></div>
</div>
<p>Authentication has to be setup in the system, e.g. via certificates in the <code class="docutils literal notranslate"><span class="pre">.globus</span></code> directory.
Usually, this is already the case and no action has to be taken.
The keyword argument to the remote provider allows to set the number of retries (10 per default) in case of failed commands (the GRID is usually relatively unreliable).
The latter may be unsupported depending on the system configuration.</p>
<p>Note that GridFTP support used together with the flags <code class="docutils literal notranslate"><span class="pre">--no-shared-fs</span></code> and <code class="docutils literal notranslate"><span class="pre">--default-remote-provider</span></code> enables you
to transparently use Snakemake in a grid computing environment without a shared network filesystem.
For an example see the <a class="reference external" href="https://github.com/Snakemake-Profiles/surfsara-grid">surfsara-grid configuration profile</a>.</p>
</div>
<div class="section" id="remote-cross-provider-transfers">
<h2>Remote cross-provider transfers<a class="headerlink" href="#remote-cross-provider-transfers" title="Permalink to this headline">¶</a></h2>
<p>It is possible to use Snakemake to transfer files between remote providers (using the local machine as an intermediary), as long as the sub-directory (bucket) names differ:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.GS</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">GSRemoteProvider</span>
<span class="kn">from</span> <span class="nn">snakemake.remote.S3</span> <span class="kn">import</span> <span class="n">RemoteProvider</span> <span class="k">as</span> <span class="n">S3RemoteProvider</span>

<span class="n">GS</span> <span class="o">=</span> <span class="n">GSRemoteProvider</span><span class="p">(</span><span class="n">access_key_id</span><span class="o">=</span><span class="s2">&quot;MYACCESSKEYID&quot;</span><span class="p">,</span> <span class="n">secret_access_key</span><span class="o">=</span><span class="s2">&quot;MYSECRETACCESSKEY&quot;</span><span class="p">)</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">S3RemoteProvider</span><span class="p">(</span><span class="n">access_key_id</span><span class="o">=</span><span class="s2">&quot;MYACCESSKEYID&quot;</span><span class="p">,</span> <span class="n">secret_access_key</span><span class="o">=</span><span class="s2">&quot;MYSECRETACCESSKEY&quot;</span><span class="p">)</span>

<span class="n">fileList</span><span class="p">,</span> <span class="o">=</span> <span class="n">S3</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;source-bucket/{file}.bam&quot;</span><span class="p">)</span>
<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">GS</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span> <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;destination-bucket/{file}.bam&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">fileList</span><span class="p">)</span> <span class="p">)</span>
<span class="n">rule</span> <span class="n">transfer_S3_to_GS</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">S3</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span> <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;source-bucket/{file}.bam&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">fileList</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="n">GS</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span> <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;destination-bucket/{file}.bam&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">fileList</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">run</span><span class="p">:</span>
        <span class="n">shell</span><span class="p">(</span><span class="s2">&quot;cp {input} {output}&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="irods">
<h2>iRODS<a class="headerlink" href="#irods" title="Permalink to this headline">¶</a></h2>
<p>You can access an iRODS server to retrieve data from and upload data to it.
If your iRODS server is not set to a certain timezone, it is using UTC. It is
advised to shift the modification time provided by iRODS (<code class="docutils literal notranslate"><span class="pre">modify_time</span></code>)
then to your timezone by providing the <code class="docutils literal notranslate"><span class="pre">timezone</span></code> parameter such that
timestamps coming from iRODS are converted to the correct time.</p>
<p>iRODS actually does not save the timestamp from your original file but creates
its own timestamp of the upload time. When iRODS downloads the file for
processing, it does not take the timestamp from the remote file. Instead,
the file will have the timestamp when it was downloaded. To get around this,
we create a metadata entry to store the original file stamp from your system
and alter the timestamp of the downloaded file accordingly. While uploading,
the metadata entries <code class="docutils literal notranslate"><span class="pre">atime</span></code>, <code class="docutils literal notranslate"><span class="pre">ctime</span></code> and <code class="docutils literal notranslate"><span class="pre">mtime</span></code> are added. When this
entry does not exist (because this module didn’t upload the file), we fall back
to the timestamp provided by iRODS with the above mentioned strategy.</p>
<p>To access the iRODS server you need to have an iRODS environment configuration
file available and in this file the authentication needs to be configured.
The iRODS configuration file can be created by following the <a class="reference external" href="https://docs.irods.org/master/system_overview/configuration/#irodsirods_environmentjson">official
instructions</a>).</p>
<p>The default location for the configuration file is
<code class="docutils literal notranslate"><span class="pre">~/.irods/irods_environment.json</span></code>.  The <code class="docutils literal notranslate"><span class="pre">RemoteProvider()</span></code> class accepts
the parameter <code class="docutils literal notranslate"><span class="pre">irods_env_file</span></code> where an alternative path to the
<code class="docutils literal notranslate"><span class="pre">irods_environment.json</span></code> file can be specified.  Another way is to export the
environment variable <code class="docutils literal notranslate"><span class="pre">IRODS_ENVIRONMENT_FILE</span></code> in your shell to specify the
location.</p>
<p>There are several ways to configure the authentication against the iRODS
server, depending on what your iRODS server offers. If you are using the
authentication via password, the default location of the authentication file is
<code class="docutils literal notranslate"><span class="pre">~/.irods/.irodsA</span></code>. Usually this file is generated with the <code class="docutils literal notranslate"><span class="pre">iinit</span></code> command
from the <code class="docutils literal notranslate"><span class="pre">iCommands</span></code> program suite. Inside the <code class="docutils literal notranslate"><span class="pre">irods_environment.json</span></code>
file, the parameter <code class="docutils literal notranslate"><span class="pre">&quot;irods_authentication_file&quot;</span></code> can be set to specifiy an
alternative location for the <code class="docutils literal notranslate"><span class="pre">.irodsA</span></code> file. Another possibility to change
the location is to export the environment variable
<code class="docutils literal notranslate"><span class="pre">IRODS_AUTHENTICATION_FILE</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">glob_wildcards()</span></code> function is supported.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snakemake.remote.iRODS</span> <span class="kn">import</span> <span class="n">RemoteProvider</span>

<span class="n">irods</span> <span class="o">=</span> <span class="n">RemoteProvider</span><span class="p">(</span><span class="n">irods_env_file</span><span class="o">=</span><span class="s1">&#39;setup-data/irods_environment.json&#39;</span><span class="p">,</span>
                       <span class="n">timezone</span><span class="o">=</span><span class="s2">&quot;Europe/Berlin&quot;</span><span class="p">)</span> <span class="c1"># all parameters are optional</span>

<span class="c1"># please note the comma after the variable name!</span>
<span class="c1"># access: irods.remote(expand(&#39;home/rods/{f}), f=files))</span>
<span class="n">files</span><span class="p">,</span> <span class="o">=</span> <span class="n">irods</span><span class="o">.</span><span class="n">glob_wildcards</span><span class="p">(</span><span class="s1">&#39;home/rods/{files})</span>

<span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">irods</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;home/rods/testfile.out&#39;</span><span class="p">),</span>

<span class="n">rule</span> <span class="n">gen</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">irods</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;home/rods/testfile.in&#39;</span><span class="p">)</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="n">irods</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;home/rods/testfile.out&#39;</span><span class="p">)</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        touch {output}</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>An example for the iRODS configuration file (<code class="docutils literal notranslate"><span class="pre">irods_environment.json</span></code>):</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;irods_host&quot;</span><span class="p">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="nt">&quot;irods_port&quot;</span><span class="p">:</span> <span class="mi">1247</span><span class="p">,</span>
    <span class="nt">&quot;irods_user_name&quot;</span><span class="p">:</span> <span class="s2">&quot;rods&quot;</span><span class="p">,</span>
    <span class="nt">&quot;irods_zone_name&quot;</span><span class="p">:</span> <span class="s2">&quot;tempZone&quot;</span><span class="p">,</span>
    <span class="nt">&quot;irods_authentication_file&quot;</span><span class="p">:</span> <span class="s2">&quot;setup-data/.irodsA&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Please note that the <code class="docutils literal notranslate"><span class="pre">zone</span></code> folder is not included in the path as it will be
taken from the configuration file. The path also must not start with a <code class="docutils literal notranslate"><span class="pre">/</span></code>.</p>
<p>By default, temporarily stored local files are removed. You can specify anyway
the parameter <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> to tell iRODS to overwrite existing files that are
downloaded, because iRODS complains if a local file already exists when a
download attempt is issued (uploading is not a problem, though).</p>
<p>In the Snakemake source directory in <code class="docutils literal notranslate"><span class="pre">snakemake/tests/test_remote_irods</span></code> you
can find a working example.</p>
</div>
<div class="section" id="ega">
<h2>EGA<a class="headerlink" href="#ega" title="Permalink to this headline">¶</a></h2>
<p>The European Genome-phenome Archive (EGA) is a service for permanent archiving
and sharing of all types of personally identifiable genetic and phenotypic data
resulting from biomedical research projects.</p>
<p>From version 5.2 on, Snakemake provides experimental support to use EGA as a remote provider, such that
EGA hosted files can be transparently used as input.
For this to work, you need to define your username and password as environment
variables <code class="docutils literal notranslate"><span class="pre">EGA_USERNAME</span></code> and <code class="docutils literal notranslate"><span class="pre">EGA_PASSWORD</span></code>.</p>
<p>Files in a dataset are addressed via the pattern <code class="docutils literal notranslate"><span class="pre">ega/&lt;dataset_id&gt;/&lt;filename&gt;</span></code>.
Note that the filename should not include the <code class="docutils literal notranslate"><span class="pre">.cip</span></code> ending that is sometimes displayed in EGA listings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">snakemake.remote.EGA</span> <span class="kn">as</span> <span class="nn">EGA</span>

<span class="n">ega</span> <span class="o">=</span> <span class="n">EGA</span><span class="o">.</span><span class="n">RemoteProvider</span><span class="p">()</span>


<span class="n">rule</span> <span class="n">a</span><span class="p">:</span>
  <span class="nb">input</span><span class="p">:</span>
      <span class="n">ega</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;ega/EGAD00001002142/COLO_829_EPleasance_TGENPipe.bam.bai&quot;</span><span class="p">)</span>
  <span class="n">output</span><span class="p">:</span>
      <span class="s2">&quot;data/COLO_829BL_BCGSC_IlluminaPipe.bam.bai&quot;</span>
  <span class="n">shell</span><span class="p">:</span>
      <span class="s2">&quot;cp {input} {output}&quot;</span>
</pre></div>
</div>
<p>Upon download, Snakemake will automatically decrypt the file and check the MD5 hash.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="utils.html" class="btn btn-neutral float-right" title="Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modularization.html" class="btn btn-neutral float-left" title="Modularization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2016, Johannes Koester

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>